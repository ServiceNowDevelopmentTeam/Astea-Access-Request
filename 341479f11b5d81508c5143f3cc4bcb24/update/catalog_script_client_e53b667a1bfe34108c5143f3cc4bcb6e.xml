<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="catalog_script_client">
    <catalog_script_client action="INSERT_OR_UPDATE">
        <active>true</active>
        <applies_catalog>false</applies_catalog>
        <applies_extended>false</applies_extended>
        <applies_req_item>true</applies_req_item>
        <applies_sc_task>false</applies_sc_task>
        <applies_target_record>false</applies_target_record>
        <applies_to>item</applies_to>
        <cat_item display_value="Astea Access Request">8cb8e26a1b1478508c5143f3cc4bcb52</cat_item>
        <cat_variable/>
        <condition/>
        <description/>
        <field/>
        <global>true</global>
        <isolate_script>false</isolate_script>
        <messages/>
        <name>User Pass Mandatory if Task Closed(RITM)</name>
        <order>1000</order>
        <published_ref/>
        <script><![CDATA[function onLoad() {
    ////////////////////////////////////////////////////////////////////////////////////
    //If AD task is open, then New Employee Email is not mandatory. - new_employee_email
    //Paired with New Hire New Email Required business rule
    ////////////////////////////////////////////////////////////////////////////////////

    //Get AD account tasks that aren't closed
    var taskGr = new GlideRecord('sc_task');
    taskGr.addQuery('request_item', g_form.getUniqueValue());
    //taskGr.addQuery('state','==', '111');
    //taskGr.addQuery('state','!=', '3');
	taskGr.addQuery('state', '111');
	taskGr.addQuery('cat_item','8cb8e26a1b1478508c5143f3cc4bcb52');
    taskGr.query();
	
    //If there are open AD Tasks, then set email not mandatory
    if (taskGr.hasNext() && (g_form.getValue('user_name_astea') == '' || g_form.getValue('temporary_password') == '') && g_form.getValue('request_type').toString() != 'Remove Access') {//If found and ritm is new hire request
		
		//console.log('form id : ' + g_form.getUniqueValue());
		
		g_form.setMandatory('user_name_astea', true);
		g_form.setMandatory('temporary_password', true);
		//g_form.setValue('user_name_astea'. g_form.getUniqueValue());
		//Add error under field
		//g_form.showErrorBox('user_name_astea','This field is communicated back to the user once the provisioning task is complete.',false);
		g_form.showErrorBox('user_name_astea','This field is communicated back to the user once the provisioning task is complete.',false);
		//Add error under field
		//g_form.showErrorBox('temporary_password','This field is communicated back to the user once the provisioning task is complete.',false);
		g_form.showErrorBox('temporary_password','This field is communicated back to the user once the provisioning task is complete.');
    }
		else{//Else make the field not mandatory
		g_form.setMandatory('user_name_astea', false);
		g_form.setMandatory('temporary_password', false);
	}
}]]></script>
        <sys_class_name>catalog_script_client</sys_class_name>
        <sys_created_by>Terry.Lillo</sys_created_by>
        <sys_created_on>2021-09-28 17:55:54</sys_created_on>
        <sys_domain>global</sys_domain>
        <sys_domain_path>/</sys_domain_path>
        <sys_id>e53b667a1bfe34108c5143f3cc4bcb6e</sys_id>
        <sys_mod_count>15</sys_mod_count>
        <sys_name>User Pass Mandatory if Task Closed(RITM)</sys_name>
        <sys_overrides/>
        <sys_package display_value="Global" source="global">global</sys_package>
        <sys_policy/>
        <sys_scope display_value="Astea Access Request">341479f11b5d81508c5143f3cc4bcb24</sys_scope>
        <sys_update_name>catalog_script_client_e53b667a1bfe34108c5143f3cc4bcb6e</sys_update_name>
        <sys_updated_by>John.Schwab</sys_updated_by>
        <sys_updated_on>2023-04-20 17:09:14</sys_updated_on>
        <table/>
        <type>onLoad</type>
        <ui_type>10</ui_type>
        <va_supported>true</va_supported>
        <variable_set/>
        <view/>
    </catalog_script_client>
    <sys_claim action="INSERT_OR_UPDATE">
        <claim_owner_scope display_value="Astea Access Request">341479f11b5d81508c5143f3cc4bcb24</claim_owner_scope>
        <claim_timestamp>17e9cfed0fa0000001</claim_timestamp>
        <metadata_update_name>catalog_script_client_e53b667a1bfe34108c5143f3cc4bcb6e</metadata_update_name>
        <previous_claim_app_version>1.0.0</previous_claim_app_version>
        <previous_claim_name>Astea Access Request</previous_claim_name>
        <previous_claim_scope>341479f11b5d81508c5143f3cc4bcb24</previous_claim_scope>
        <sys_created_by>Terry.Lillo</sys_created_by>
        <sys_created_on>2022-01-27 19:24:12</sys_created_on>
        <sys_id>aec78af11bdd81508c5143f3cc4bcbde</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>Terry.Lillo</sys_updated_by>
        <sys_updated_on>2022-10-05 19:12:38</sys_updated_on>
    </sys_claim>
</record_update>
